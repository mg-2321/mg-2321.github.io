<!DOCTYPE html>
<html lang="en"> 
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gayatri Malladi</title>
  <meta name="description" content="Gayatri Malladi — NLP/LLM‑themed portfolio. Projects, papers, writing, and photography." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='85'>GM</text></svg>">
  <style>
  /* Light / Dark tokens */
  :root{--fg:#14161a;--muted:#5b6574;--link:#0b57d0;--bg:#ffffff;--rule:#e7ebf0;--pill:#f2f6ff}
  [data-theme="dark"]{--fg:#e8ecf4;--muted:#a7b0c0;--link:#a5b4fc;--bg:#0a0b0f;--rule:#1b2230;--pill:#0f1525}
  @media (prefers-color-scheme: dark){:root:not([data-theme]){--fg:#e8ecf4;--muted:#a7b0c0;--link:#a5b4fc;--bg:#0a0b0f;--rule:#1b2230;--pill:#0f1525}}
  
  html{font-size:16px}
  body{margin:0 auto;max-width:900px;padding:26px 16px 64px;line-height:1.65;color:var(--fg);background:var(--bg);
        font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji")}
  h1,h2,h3{line-height:1.22;margin:1.15em 0 .55em}
  h1{font-size:2.55rem;margin-top:0}
  h2{font-size:1.55rem;position:relative}
  h2::after{content:"";display:block;width:56px;height:3px;background:linear-gradient(90deg,#0b57d0,#8b5cf6);
            border-radius:3px;margin-top:6px;opacity:.85}
  h3{font-size:1.06rem;letter-spacing:.2px}
  p,ul{margin:.45em 0}
  a{color:var(--link);text-decoration:none}
  a:hover{text-decoration:underline}
  .muted{color:var(--muted)}
  .row-links a{margin-right:.6rem}
  .hr{height:1px;background:var(--rule);margin:24px 0}
  
  /* mini anchor nav + theme toggle (right side) */
  .mini-bar{display:flex;justify-content:space-between;align-items:center;margin:.2rem 0 1rem}
  .mini-nav a{font-size:.94rem;margin-right:.8rem;padding:2px 8px;border-radius:999px;border:1px solid transparent}
  .mini-nav a:hover{background:var(--pill);border-color:#2b3b62;text-decoration:none}
  .theme-toggle{border:1px solid var(--rule);padding:6px 10px;border-radius:10px;background:transparent;color:var(--fg);cursor:pointer}
  
  /* avatar – square */
  .avatar{float:right;width:170px;height:170px;border-radius:14px;object-fit:cover;border:1px solid var(--rule);margin:0 0 8px 16px}
  
  /* token ribbon (subtle LLM vibe) */
  .tokenribbon{position:relative;border:1px solid var(--rule);border-radius:12px;overflow:hidden;
               background:linear-gradient(90deg,rgba(15,92,255,.05) 0,transparent 50%,rgba(15,92,255,.05) 100%)}
  .track{display:flex;gap:2rem;white-space:nowrap;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:.88rem;
         padding:10px 12px;color:#264;opacity:.9}
  [data-theme="dark"] .track{color:#9fb3d9}
  .scroll{animation:marquee 26s linear infinite}
  .scroll2{animation:marquee 34s linear infinite reverse}
  @keyframes marquee{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
  @media (prefers-reduced-motion: reduce){.scroll,.scroll2{animation:none}}
  
  /* entries */
  .entry{display:grid;grid-template-columns:200px 1fr;gap:14px;align-items:start;margin:16px 0 22px}
  .entry .thumb{position:relative;width:200px;aspect-ratio:16/10;object-fit:cover;border:1px solid var(--rule);
                border-radius:12px;overflow:hidden}
  .entry .thumb::after{content:"";position:absolute;inset:0;
    background:linear-gradient(90deg,rgba(11,87,208,.08) 1px,transparent 1px) 0 0/12px 100%,
               linear-gradient(rgba(11,87,208,.08) 1px,transparent 1px) 0 0/100% 12px;
    mix-blend-mode:multiply;opacity:.9;animation:drift 16s linear infinite}
  [data-theme="dark"] .entry .thumb::after{
    background:linear-gradient(90deg,rgba(165,180,252,.15) 1px,transparent 1px) 0 0/12px 100%,
               linear-gradient(rgba(165,180,252,.15) 1px,transparent 1px) 0 0/100% 12px}
  @keyframes drift{0%{background-position:0 0,0 0}100%{background-position:160px 0,0 160px}}
  .entry:hover .thumb{transform:translateY(-2px);box-shadow:0 10px 28px rgba(25,71,170,.12);
                      transition:transform .2s ease, box-shadow .2s ease}
  @media (prefers-reduced-motion: reduce){.entry .thumb::after{animation:none}}
  @media (max-width:680px){.entry{grid-template-columns:1fr}.entry .thumb{width:100%}}
  
  /* buttons & chips */
  .row-links .btn{display:inline-block;border:1px solid var(--rule);padding:6px 10px;border-radius:10px;text-decoration:none;margin-right:.45rem}
  .btn:hover{background:#f0f4ff14;text-decoration:none;border-color:#8b5cf6}
  .pill{display:inline-block;font-size:.75rem;color:#244;padding:2px 8px;border-radius:999px;background:var(--pill);border:1px solid #d8e4ff;margin-bottom:.25rem}
  [data-theme="dark"] .pill{color:#b6c4ff;border-color:#2a3660}
  
  /* playground (tokenizer) */
  .playground{border:1px solid var(--rule);border-radius:12px;padding:12px}
  .playground input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--rule)}
  .tokens{display:flex;flex-wrap:wrap;gap:6px;margin-top:10px}
  .tok{font:600 .8rem ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;padding:4px 8px;border-radius:8px;background:#f1f4fb;border:1px solid #dbe3f3}
  [data-theme="dark"] .tok{background:#101a33;border-color:#2a3660}
  .stats{font-size:.85rem;color:var(--muted);margin-top:6px}
  
  /* Q&A widget */
  .qa{border:1px solid var(--rule);border-radius:12px;padding:12px}
  .qa .ask{display:flex;gap:8px}
  .qa input{flex:1;padding:10px 12px;border-radius:10px;border:1px solid var(--rule)}
  .qa button{border:1px solid var(--rule);border-radius:10px;padding:8px 12px;background:#f7faff}
  [data-theme="dark"] .qa button{background:#121a2a}
  .qa .suggest{margin-top:8px;display:flex;flex-wrap:wrap;gap:8px}
  .qa .chip{border:1px solid var(--rule);border-radius:999px;padding:4px 8px;font-size:.85rem;background:#fff;cursor:pointer}
  [data-theme="dark"] .qa .chip{background:#0c1220}
  .qa .chat{margin-top:12px;display:flex;flex-direction:column;gap:10px}
  .bubble{background:#f7faff;border:1px solid #d8e4ff;padding:10px 12px;border-radius:12px}
  .bubble.me{align-self:flex-end;background:#eef3ff}
  .bubble.bot{align-self:flex-start}
  [data-theme="dark"] .bubble{background:#0f162a;border-color:#2a3660}
  
  /* lead intro */
  .lead{font-size:1.06rem;line-height:1.9}
  </style>

</head>
<script>
(function(){
  const root = document.documentElement;
  const pref = localStorage.getItem('theme');
  if (pref) root.setAttribute('data-theme', pref);
  else if (matchMedia('(prefers-color-scheme: dark)').matches) root.setAttribute('data-theme','dark');
  const btn = document.getElementById('themeToggle');
  const setIcon = () => btn.textContent = (root.getAttribute('data-theme') === 'dark') ? '☀️' : '🌙';
  btn.addEventListener('click', () => {
    const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    root.setAttribute('data-theme', next); localStorage.setItem('theme', next); setIcon();
  });
  setIcon();
})();
</script>
<body>
  <main>
    <h1>Gayatri Malladi</h1>
    <p class="mini-nav">
      <a href="#projects">Projects</a>
      <a href="#writing">Writing</a>
      <a href="#experience">Experience</a>
      <a href="#education">Education</a>
    </p>

    <!-- Your photo (upload images/photo.jpg) -->
    $1
    <p class="lead">I’m a second-year M.S. student in the <strong>Data Science</strong> department at the <strong>University of Washington, Seattle</strong>. I study <strong>agentic AI</strong>—teaching language models when to <em>ask</em> and when to <em>act</em>—with lightweight grounding via a <strong>knowledge-augmented graph (KAG)</strong> and preference-based training (<strong>SFT → per-step DPO/SimPO</strong>; <strong>KTO</strong> and <strong>ORPO</strong> for asymmetric ask/act risk).</p>
    <p class="lead">Beyond policy learning, I work on <strong>context management</strong> for LLMs: short- and long-term retrieval caches, summarization/compression, and <strong>Reflexion-style episodic notes</strong> that are indexed and reused across tasks.</p>
    <p class="lead">I’m open to research collaboration—email <a href="mailto:gayat23@uw.edu">gayat23@uw.edu</a>—especially on <strong>assistive agents</strong> (day-to-day task automation, tool use, XR copilots) and <strong>self-evolving LLMs</strong> (curriculum generation, reflective fine-tuning, preference optimization) spanning <em>Perception · Reasoning · Planning · Learning · Execution · Verification</em>.</p>

    <p class="row-links">
      <a href="resume.pdf" target="_blank" rel="noopener">CV</a> /
      <a href="https://www.linkedin.com/in/gayatri-malladi/" target="_blank" rel="me noopener">LinkedIn</a> /
      <a href="https://github.com/mg-2321" target="_blank" rel="me noopener">GitHub</a> /
      <a href="https://medium.com/@YOUR_MEDIUM_HANDLE" target="_blank" rel="me noopener">Medium</a> /
      <a href="https://instagram.com/YOUR_PHOTOGRAPHY_HANDLE" target="_blank" rel="me noopener">Instagram (Photography)</a>
    </p>

    <!-- Innovative LLM hero ribbon -->
    <div class="tokenribbon" aria-hidden="true">
      <div class="track scroll">token → embedding → attention → head1 • head2 • head8 → logits → loss → update · prompt → retrieval → context → decoding → evals</div>
      <div class="track scroll2">beam search → nucleus → sampling → temperature → perplexity → AUC → F1 · CUDA → Waymo → EEG → agents → graphs</div>
    </div>

    <!-- Tokenizer Playground -->
    <div class="playground" style="margin-top:14px">
      <label for="tokInput" class="muted" style="font-size:.9rem">Tokenizer Playground — type a sentence (just a visual; no network calls)</label>
      <input id="tokInput" type="text" placeholder="e.g., Planning under uncertainty with diffusion models" />
      <div id="tokens" class="tokens" aria-live="polite"></div>
      <div id="tokStats" class="stats"></div>
    </div>

    <h2 id="projects">Projects</h2>

    <h3><span class="pill">Agents & Planning</span></h3>
    <div class="entry">
      <img class="thumb" src="images/agents-kag.jpg" alt="Knowledge-aware agent"/>
      <div>
        <strong>Solving Short‑term Memory Limits of ADAPT Agents</strong> <span class="muted">— May 2025 – Present</span>
        <p>Added a <em>Knowledge‑Aware Graph</em> module for long‑term user preferences and a diffusion‑style drive model for smoother planning under uncertainty.</p>
        <p class="row-links"><a class="btn" href="https://github.com/mg-2321" target="_blank">Code</a><a class="btn" href="papers/adapt-kag.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <h3><span class="pill">Vision & Robotics</span></h3>
    <div class="entry">
      <img class="thumb" src="images/waymo-forecast.jpg" alt="Waymo trajectories"/>
      <div>
        <strong>Future Trajectory Prediction for Autonomous Vehicles</strong> <span class="muted">— May 2025 – Present</span>
        <p>Diffusion‑based model predicting 5‑second future trajectories in long‑tail scenarios using the Waymo Open Dataset; explicitly models multimodal uncertainty.</p>
        <p class="row-links"><a class="btn" href="https://github.com/mg-2321" target="_blank">Code</a><a class="btn" href="papers/waymo-forecast.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <div class="entry">
      <img class="thumb" src="images/cuda-limo.jpg" alt="CUDA optimization"/>
      <div>
        <strong>Optimizing LIMO Pipeline with CUDA Parallelization</strong> <span class="muted">— Jan 2025 – Mar 2025</span>
        <p>Shared‑memory tiling, async transfers, and custom kernels for 2D conv, keyframe selection, and pose estimation, improving kernel time by up to 60%.</p>
        <p class="row-links"><a class="btn" href="https://github.com/mg-2321" target="_blank">Code</a><a class="btn" href="papers/limo-cuda.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <div class="entry">
      <img class="thumb" src="images/eeg-stroke.jpg" alt="EEG"/>
      <div>
        <strong>Stroke Rehabilitation — EEG Motor Action Classification</strong> <span class="muted">— Oct 2024 – Dec 2024</span>
        <p>Pre/post‑stroke EEG analysis for motor actions (hand wave, clench, face rub) with ICA, band‑pass filtering, and PCA; models: Decision Trees, SVMs, NNs.</p>
        <p class="row-links"><a class="btn" href="https://github.com/mg-2321" target="_blank">Code</a><a class="btn" href="papers/eeg-stroke.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <h3><span class="pill">NLP & Safety</span></h3>
    <div class="entry">
      <img class="thumb" src="images/nlp-si.jpg" alt="NLP for suicide risk"/>
      <div>
        <strong>NLP for Suicide Ideation & Attempt Detection</strong> <span class="muted">— Jan 2023 – Jun 2023</span>
        <p>Preprocessed clinical + forum text (MIMIC‑III, SuicideWatch); compared GloVe/Word2Vec/FastText/CBOW; trained BERT & RoBERTa vs Bi‑LSTM baselines.</p>
        <p class="row-links"><a class="btn" href="#" target="_blank">Code</a><a class="btn" href="papers/nlp-suicide-risk.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <h3><span class="pill">Security & Code Analysis</span></h3>
    <div class="entry">
      <img class="thumb" src="images/llm-security.jpg" alt="LLM code security"/>
      <div>
        <strong>LLMs for Code Vulnerability Detection</strong> <span class="muted">— Sept 2023 – Mar 2024</span>
        <p>Prompt‑engineered LLMs + RAG for vulnerable code detection with self‑explanations; GraphCodeBERT + DCGAN pipeline to flag zero‑day patterns via data‑flow visuals.</p>
        <p class="row-links"><a class="btn" href="#" target="_blank">Code</a><a class="btn" href="papers/llm-code-vuln.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <div class="entry">
      <img class="thumb" src="images/worker-safety.jpg" alt="Construction safety detection"/>
      <div>
        <strong>Real‑time Construction Worker Safety Inspection</strong> <span class="muted">— Dec 2022 – Jan 2023</span>
        <p>Benchmarked CNN/RCNN/SSD/Faster‑RCNN and integrated the best detector into a web app for on‑site deployment to reduce supervision gaps.</p>
        <p class="row-links"><a class="btn" href="#" target="_blank">Code</a><a class="btn" href="papers/worker-safety.pdf" target="_blank">Paper</a></p>
      </div>
    </div>

    <div class="hr"></div>

    <h2 id="ask">Ask about my work</h2>
    <div class="qa" role="region" aria-live="polite">
      <div class="ask">
        <input id="qaInput" type="text" placeholder="Ask about any project (e.g., What model did you use for trajectory prediction?)" />
        <button id="qaBtn" type="button">Ask</button>
      </div>
      <div class="suggest">
        <span class="chip" data-q="What did you build for Waymo trajectory forecasting?">Waymo model?</span>
        <span class="chip" data-q="How did you optimize CUDA kernels in the LIMO project?">CUDA speedups?</span>
        <span class="chip" data-q="What is the Knowledge‑Aware Graph in your agent project?">Agent KAG?</span>
        <span class="chip" data-q="Which datasets and models did you use for suicide ideation detection?">NLP dataset?</span>
        <span class="chip" data-q="Do you have papers to read for each project?">Papers?</span>
      </div>
      <div id="qaChat" class="chat" aria-live="polite"></div>
    </div>

    <div class="hr"></div>

    <h2 id="writing">Writing</h2>
    <p>Read more on <a href="https://medium.com/@YOUR_MEDIUM_HANDLE" target="_blank" rel="me noopener">Medium</a>. Add a couple of featured posts here for quick access.</p>

    <div class="entry">
      <img class="thumb" src="images/medium-cover-1.jpg" alt="Post cover"/>
      <div>
        <strong><a href="https://medium.com/@YOUR_MEDIUM_HANDLE/YOUR_POST_SLUG" target="_blank" rel="noopener">Title of your post</a></strong> <span class="muted">— Month YYYY</span>
        <p>One‑line summary of the article.</p>
      </div>
    </div>

    <div class="hr"></div>

    <h2 id="experience">Experience</h2>
    <p><strong>Research Intern</strong>, Centre for Development of Advanced Computing (C‑DAC) — <span class="muted">Sept 2023 – Mar 2024</span></p>
    <ul>
      <li>LLMs for vulnerable code detection using <em>Prompt Engineering</em> + <em>RAG</em> with self‑explanations.</li>
      <li>GraphCodeBERT + DCGAN pipeline; data‑flow visualizations of insecure design.</li>
    </ul>

    <p><strong>Researcher</strong>, National University of Singapore — <span class="muted">Jan 2023 – Jun 2023</span></p>
    <ul>
      <li>Prepared clinical & forum datasets; expanded abbreviations; noise removal for clarity.</li>
      <li>Compared vectorizers (GloVe, Word2Vec, FastText, CBOW) and models (BERT, RoBERTa, Bi‑LSTM).</li>
    </ul>

    <p><strong>Research Intern</strong>, National University of Singapore & Hewlett Packard Enterprise — <span class="muted">Dec 2022 – Jan 2023</span></p>
    <ul>
      <li>Optimized worker safety inspection; compared CNN/RCNN/SSD/Faster‑RCNN; integrated best model into a website.</li>
    </ul>

    <div class="hr"></div>

    <h2 id="education">Education</h2>
    <p><strong>University of Washington Bothell</strong> — M.S. in Computer Science & Software Engineering, <span class="muted">Expected Jun 2026</span><br/>
      <span class="muted">GPA: 3.93/4.0 • Coursework: Machine Learning; Data Mining for ML; High Performance Computing; Research Methods; Computer Vision; NLP; Software Architecture</span></p>
    <p><strong>Sri Ramaswamy Memorial Institute of Science and Technology</strong> — B.Tech in Computer Science with Software Engineering, <span class="muted">Sept 2020 – Jun 2024</span></p>

    <div class="hr"></div>

    <p class="muted">© <span id="yr"></span> Gayatri Malladi</p>
  </main>
  <script>
    // Footer year
    document.getElementById('yr').textContent = new Date().getFullYear();

    // Simple visual tokenizer (manual, no regex to keep the file portable)
    function isWordChar(ch){
      const code = ch.charCodeAt(0);
      const isNum = code>=48 && code<=57;
      const isUp  = code>=65 && code<=90;
      const isLo  = code>=97 && code<=122;
      return isNum || isUp || isLo || ch === '_';
    }
    const input = document.getElementById('tokInput');
    const out = document.getElementById('tokens');
    const stats = document.getElementById('tokStats');
    function tokenize(str){
      const toks=[]; let cur=''; let mode=null;
      for(const ch of str){
        const w = isWordChar(ch);
        if(mode===null){ mode=w; cur=ch; }
        else if((w && mode) || (!w && !mode)){ cur+=ch; }
        else { toks.push(cur); cur=ch; mode=w; }
      }
      if(cur) toks.push(cur);
      return toks.map(p=> p.length>6? p.slice(0,4)+'…' : p);
    }
    function render(){
      const val = input.value.trim();
      const toks = val? tokenize(val): [];
      out.innerHTML = toks.map(t=> `<span class="tok">${t}</span>`).join('');
      stats.textContent = val? `${toks.length} tokens (illustrative)` : '';
    }
    input.addEventListener('input', render);
    render();

    // ======================= Q&A SECTION =======================
    const kb = [
      { id:'waymo', title:'Future Trajectory Prediction for Autonomous Vehicles',
        summary:'Diffusion-based model forecasting 5-second trajectories on the Waymo Open Dataset; models multimodal uncertainty and temporal dependencies.',
        tags:'diffusion trajectory forecasting waymo uncertainty driving pytorch',
        code:'https://github.com/mg-2321', paper:'papers/waymo-forecast.pdf',
        details:{dataset:'Waymo Open Dataset', models:'Diffusion-based sequence model', metrics:'5s horizon, multimodal predictions'} },
      { id:'agents', title:'Solving Short‑term Memory Limits of ADAPT Agents',
        summary:'Added a Knowledge‑Aware Graph for long‑term user preferences and a diffusion-style drive model for smoother planning.',
        tags:'agent VLA ADAPT KAG graph reinforcement learning planning diffusion',
        code:'https://github.com/mg-2321', paper:'papers/adapt-kag.pdf',
        details:{approach:'Knowledge‑Aware Graph + planning under uncertainty', focus:'user preference memory'} },
      { id:'cuda', title:'Optimizing LIMO Pipeline with CUDA Parallelization',
        summary:'Shared‑memory tiling, async copies, and custom conv kernels; Nsight-guided profiling with up to 60% kernel time speedup.',
        tags:'cuda gpu kernels convolution shared-memory tiling nsight optimization limo',
        code:'https://github.com/mg-2321', paper:'papers/limo-cuda.pdf',
        details:{tech:'shared memory tiling, streams, async transfers', result:'~60% kernel time reduction'} },
      { id:'eeg', title:'Stroke Rehabilitation — EEG Motor Action Classification',
        summary:'ICA + filtering + PCA features; DT/SVM/NN models to compare pre/post‑stroke EEG for motor actions.',
        tags:'eeg signal processing ica pca svm neural',
        code:'#', paper:'papers/eeg-stroke.pdf',
        details:{actions:'hand wave, clench, face rub', methods:'ICA, band‑pass, PCA'} },
      { id:'nlp', title:'NLP for Suicide Ideation & Attempt Detection',
        summary:'Preprocessed clinical & forum text; compared GloVe/Word2Vec/FastText/CBOW; trained BERT/RoBERTa vs Bi‑LSTM.',
        tags:'nlp suicide ideation attempt mimic-iii suicidewatch bert roberta bi-lstm',
        code:'#', paper:'papers/nlp-suicide-risk.pdf',
        details:{datasets:'MIMIC‑III, r/SuicideWatch', models:'BERT, RoBERTa, Bi‑LSTM'} },
      { id:'vuln', title:'LLMs for Code Vulnerability Detection',
        summary:'Prompt‑engineered LLMs + RAG; GraphCodeBERT + DCGAN to flag zero‑day patterns via data‑flow visuals.',
        tags:'security code vulnerability llm rag graphcodebert dcgan',
        code:'#', paper:'papers/llm-code-vuln.pdf',
        details:{approach:'Prompting + retrieval, GraphCodeBERT classifier', extras:'data‑flow visualizations'} },
      { id:'safety', title:'Real‑time Construction Worker Safety Inspection',
        summary:'Benchmarked CNN/RCNN/SSD/Faster‑RCNN and deployed the best model in a web app to reduce on‑site risks.',
        tags:'cv object detection faster-rcnn cnn rcnn ssd web',
        code:'#', paper:'papers/worker-safety.pdf',
        details:{models:'Faster‑RCNN vs SSD/RCNN', deploy:'web integration'} }
    ];

    const synonyms = {
      waymo:['trajectory','trajectories','forecast','forecasting','autonomous','driving'],
      diffusion:['score','denoise','latent'],
      cuda:['gpu','parallel','kernel','kernels','nsight','tiling','memory'],
      eeg:['brain','signal','emg','electrode'],
      suicide:['si','sa','ideation','attempt'],
      vulnerability:['security','vuln','cwe','code'],
      agent:['agents','adapt','kag','planning','preferences']
    };

    function tokensOf(q){
      return q.toLowerCase().split(/[^a-z0-9_]+/).filter(Boolean);
    }
    function expandTokens(ts){
      const out = new Set(ts);
      for(const t of ts){
        for(const [k,vals] of Object.entries(synonyms)){
          if(t===k || vals.includes(t)) { out.add(k); vals.forEach(v=>out.add(v)); }
        }
      }
      return Array.from(out);
    }
    function scoreItem(item, qts){
      let s = 0; const title=item.title.toLowerCase(); const tags=(item.tags||'').toLowerCase(); const sum=(item.summary||'').toLowerCase();
      for(const t of qts){
        if(title.includes(t)) s+=4;
        if(tags.includes(t)) s+=3;
        if(sum.includes(t)) s+=2;
      }
      if(qts.includes('paper') && item.paper) s+=2;
      if(qts.includes('code') && item.code) s+=2;
      return s;
    }
    function bestMatches(q){
      const qts = expandTokens(tokensOf(q));
      const ranked = kb.map(it=>({it,score:scoreItem(it,qts)})).sort((a,b)=>b.score-a.score);
      return ranked.filter(x=>x.score>0).slice(0,3);
    }
    function fmtLinks(it){
      const links = [];
      if(it.code && it.code!=='#') links.push(`<a href="${it.code}" target="_blank">Code</a>`);
      if(it.paper) links.push(`<a href="${it.paper}" target="_blank">Paper</a>`);
      return links.length? ` · ${links.join(' | ')}` : '';
    }
    function answerFor(it, q){
      const ql = q.toLowerCase();
      const d = it.details||{}; let msg = `<strong>${it.title}</strong>`;
      if(/model|architecture|approach|how/.test(ql) && d.models){ msg += ` — Model: ${d.models}.`; }
      else if(/dataset|data|corpus/.test(ql) && (d.dataset||d.datasets)){ msg += ` — Dataset: ${d.dataset||d.datasets}.`; }
      else if(/metric|result|speed|improv/.test(ql) && (d.metrics||d.result)){ msg += ` — Results: ${d.metrics||d.result}.`; }
      else { msg += ` — ${it.summary}`; }
      msg += fmtLinks(it);
      return msg;
    }

    const chat = document.getElementById('qaChat');
    const qaInput = document.getElementById('qaInput');
    const qaBtn = document.getElementById('qaBtn');

    function pushUserBubble(text){
      const b = document.createElement('div'); b.className='bubble me'; b.textContent=text; chat.appendChild(b); chat.scrollTop = chat.scrollHeight;
    }
    function pushBotBubble(html){
      const b = document.createElement('div'); b.className='bubble bot'; b.innerHTML=html; chat.appendChild(b); chat.scrollTop = chat.scrollHeight;
    }

    function ask(){
      const q = qaInput.value.trim(); if(!q) return; pushUserBubble(q); qaInput.value='';
      const matches = bestMatches(q);
      if(matches.length===0){
        pushBotBubble("I couldn't find that in my current projects. Try asking about <em>Waymo diffusion forecasting</em>, <em>CUDA speedups</em>, <em>Knowledge‑Aware Graph agents</em>, or <em>NLP suicide detection</em>.");
        return;
      }
      const first = matches[0].it; pushBotBubble(answerFor(first,q));
      if(matches.length>1){
        const alt = matches.slice(1).map(m=>`• ${m.it.title}${fmtLinks(m.it)}`).join('<br>');
        pushBotBubble(`<span class="muted">Related:</span><br>${alt}`);
      }
    }
    qaBtn.addEventListener('click', ask);
    qaInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') ask(); });
    document.querySelectorAll('.chip[data-q]').forEach(el=> el.addEventListener('click', ()=>{ qaInput.value = el.dataset.q; ask(); }));

  </script>
</body>
</html>
